CREATE OR REPLACE PROCEDURE P_AUX_TABLERO_NQI_HOUR_INS (P_OSSRC IN CHAR, P_FECHA_DESDE IN CHAR, P_FECHA_HASTA IN CHAR) IS

-- Autor: Monica Pellegrini. Fecha: 08.11.2016.
-- Actualizacion: Mario Heredia. Fecha: 15.05.2017.
-- Actualizacion: Mario Heredia. Fecha: 01.06.2017.

/*
CURSOR FECHAS (PSEDSD IN CHAR, PSEDSA IN CHAR, PSEDSL IN NUMBER) IS
SELECT TO_CHAR(DECODE(HTSAEFHN, HTSAEFHM, HTSAEFHE, HTSAEFHE + ((HTSAEFHN - 1) * PSEDSL / 24)       ), 'DD.MM.YYYY HH24') FECHA_DESDE,
       TO_CHAR(DECODE(HTSAEFHN, HTSAEFHX, HTSAEFHA, HTSAEFHE + ((HTSAEFHN)     * PSEDSL / 24) - 1/24), 'DD.MM.YYYY HH24') FECHA_HASTA
  FROM (
SELECT TO_DATE(PSEDSD, 'DD.MM.YYYY HH24') HTSAEFHE,
       TO_DATE(PSEDSA, 'DD.MM.YYYY HH24') HTSAEFHA,
       MAX(LEVEL) OVER() HTSAEFHX,
       MIN(LEVEL) OVER() HTSAEFHM,
       LEVEL HTSAEFHN
  FROM DUAL CONNECT BY LEVEL <=
       (
SELECT FLOOR(((HTSAEFHD * 24) + HTSAEFHH) / PSEDSL) + DECODE(MOD((HTSAEFHD * 24) + HTSAEFHH, PSEDSL), 0, 0, 1) HTSAEFHV
  FROM (
SELECT FLOOR(HTSAEFHA - HTSAEFHE) HTSAEFHD, ROUND(MOD(HTSAEFHA - HTSAEFHE, FLOOR(HTSAEFHA - HTSAEFHE)) / (1/24), 0) HTSAEFHH
  FROM (
SELECT TO_DATE(PSEDSD, 'DD.MM.YYYY HH24') HTSAEFHE,
       TO_DATE(PSEDSA, 'DD.MM.YYYY HH24') HTSAEFHA
  FROM DUAL
       )
       )
       )
       )
 ORDER BY HTSAEFHN DESC;
*/

/*
CURSOR ELEMENTOS IS
SELECT 'OSSRC5' RC FROM DUAL UNION ALL
SELECT 'OSSRC3' RC FROM DUAL UNION ALL
SELECT 'OSSRC2' RC FROM DUAL UNION ALL
SELECT 'OSSRC1' RC FROM DUAL;
*/

--C_CICLO   NUMBER := 281;
--V_CICLO   NUMBER;

--P_FECHA_DESDE  VARCHAR2(15);
--P_FECHA_HASTA  VARCHAR2(15);
--P_OSSRC        VARCHAR2(10);
V_SYSDATE      VARCHAR2(20);
W_MENSAJE      VARCHAR2(1000);

L_ERR          VARCHAR2(1000);
L_MSG          VARCHAR2(1000);

BEGIN

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_1ST_AUX_HOUR';

EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_1ST_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_UMTS_CLDD_NQI_1ST_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_UMTS_CLDD_NQI_1ST_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_UMTS_CLDD_NQI_1ST_AUX_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_2ND_AUX_HOUR';

EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_2ND_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_UMTS_CLDD_NQI_2ND_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_UMTS_CLDD_NQI_2ND_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_UMTS_CLDD_NQI_2ND_AUX_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_3RD_AUX_HOUR';

EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_3RD_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_UMTS_CLDD_NQI_3RD_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_UMTS_CLDD_NQI_3RD_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_UMTS_CLDD_NQI_3RD_AUX_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_C_RADAR_AUX_HOUR';

EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_C_RADAR_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_RADAR_C_TLOAD_NQI_HOUR_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_RADAR_C_TLOAD_NQI_HOUR_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_RADAR_C_TLOAD_NQI_HOUR_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_RADAR_AUX_HOUR';

EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_RADAR_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_RADAR_TLOAD_NQI_HOUR_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_RADAR_TLOAD_NQI_HOUR_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_RADAR_TLOAD_NQI_HOUR_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

W_MENSAJE := 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_TWP_AUX_HOUR';
EXECUTE IMMEDIATE 'TRUNCATE TABLE MHEREDIA.CLDD_NQI_TWP_AUX_HOUR';

SELECT TO_CHAR(SYSDATE, 'DD.MM.YYYY HH24:MI:SS') AHORA INTO V_SYSDATE FROM DUAL;

--FOR SEN IN ELEMENTOS LOOP

    --FOR SYN IN FECHAS (P_FECHA_DESDE, P_FECHA_HASTA, V_CICLO) LOOP

        DBMS_OUTPUT.PUT_LINE('P_UMTS_CLDD_NQI_TWP_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE);
        W_MENSAJE := 'P_UMTS_CLDD_NQI_TWP_AUX_INS '||P_FECHA_DESDE||' '||P_FECHA_HASTA||' '||P_OSSRC||' '||V_SYSDATE;

        P_UMTS_CLDD_NQI_TWP_AUX_INS (P_FECHA_DESDE, P_FECHA_HASTA, P_OSSRC);

    --END LOOP;

--DBMS_OUTPUT.PUT_LINE('');

--END LOOP;

EXCEPTION
WHEN OTHERS THEN

     L_ERR := SQLCODE;
     L_MSG := SQLERRM;

     G_ERROR_LOG_NEW.P_LOG_ERROR('P_AUX_TABLERO_NQI_HOUR_INS', L_ERR, L_MSG, W_MENSAJE);